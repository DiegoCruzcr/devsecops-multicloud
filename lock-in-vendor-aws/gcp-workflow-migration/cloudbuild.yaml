steps:
  - name: "gcr.io/cloud-builders/docker"
    args: [ "build", "-t", "us-central1-docker.pkg.dev/devsecops-multicloud/app-repo/app:latest", "." ]
  - name: "gcr.io/cloud-builders/docker"
    args: [ "push", "us-central1-docker.pkg.dev/devsecops-multicloud/app-repo/app:latest" ]
  - name: "gcr.io/google.com/cloudsdktool/cloud-sdk"
    entrypoint: gcloud
    args:
      - run
      - deploy
      - app-service
      - --image=us-central1-docker.pkg.dev/devsecops-multicloud/app-repo/app:latest
      - --region=us-central1
      - --platform=managed
      - --allow-unauthenticated
# substitutions:
#   _REGION: us-central1
#   _devsecops-multicloud: devsecops-multicloud
images:
  - "us-central1-docker.pkg.dev/devsecops-multicloud/app-repo/app:latest"
options:
  logging: CLOUD_LOGGING_ONLY